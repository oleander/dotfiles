#!/usr/bin/env ruby

# Git Manual add, version 0.1, 2011-03-09
# Copyright (c) 2011, Linus Oleander
# Released under the MIT licens
# Makes it possible to easy add files to git

require "colorize"

letters = "asdfghjklzxcvbnm".split("")
files   = `git status --porcelain`.split(/\n/)

if files.empty?
  abort("Nothing where found".green)
end

puts "### #{files.count} file(s) found ###\n".green
matches = {}
index   = 0

files.each do |file|
  next if file.split(" ").first == "A"
  file = file.split(" ").last
  puts "#{letters[index]} - #{file}".black
  matches.merge!(letters[index] => file)
  index = index + 1
end

files = gets.split("").map do |letter|
  if file = matches[letter]
    puts "Adding: %s".yellow % "#{file}".black
    file
  end
end.reject(&:nil?)

if files.any?
  system "git add #{files.join(" ")}"
else
  puts "No files where added".red
end