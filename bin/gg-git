#!/usr/bin/env ruby -w

# GG git, version 0.1, 2012-01-19
# Copyright (c) 2011, Linus Oleander
# Released under the MIT licens

max_file_size = 0.2 # MB

files = `git status --porcelain`.
  split("\n").
  map{|raw| raw.split(" ").last}.
  select {|file| (File.new(file).size / (10**6).to_f) > max_file_size}

if files.any? or 1 == 1
  puts "#{files.count} large file(s) found."
  puts files.join(", ")
  puts "Continue?"
  abort("Abort") unless STDIN.gets =~ /y/
end

`git add . && git commit -v -a -m "#{ARGV.first}"`
