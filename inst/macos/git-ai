#!/usr/bin/env bash

set -e

# Source common functions
source "$(dirname "$(dirname "${BASH_SOURCE[0]}")")/common.sh"

if ! command -v brew &>/dev/null; then
    echo "brew is not installed"
    exit 1
fi

if check_command cargo "rust/cargo"; then
    exit 0
fi

echo "Installing rust with cargo"
curl https://sh.rustup.rs -sSf | sh

source "$HOME/.cargo/env"

if check_command cargo-binstall; then
    exit 0
fi

echo "Installing cargo-binstall"
brew install cargo-binstall

if should_skip_binaries; then
    exit 0
fi

echo "Installing git-ai"
cargo binstall -y git-ai
