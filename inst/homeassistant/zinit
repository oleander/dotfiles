#!/bin/bash

set -e

# Install zinit for zsh plugin management on Linux
if [[ ! -f $HOME/.local/share/zinit/zinit.git/zinit.zsh ]]; then
    echo "Installing zinit..."

    # Ensure git is installed
    if ! command -v git &> /dev/null; then
        echo "Git is required but not installed. Installing git..."
        if command -v apt-get &> /dev/null; then
            sudo apt-get update && sudo apt-get install -y git
        elif command -v apk &> /dev/null; then
            apk add --no-cache git
        elif command -v yum &> /dev/null; then
            sudo yum install -y git
        else
            echo "Cannot install git. Please install git manually."
            exit 1
        fi
    fi

    mkdir -p "$HOME/.local/share/zinit" && chmod g-rwX "$HOME/.local/share/zinit"
    git clone https://github.com/zdharma-continuum/zinit "$HOME/.local/share/zinit/zinit.git"
    echo "Zinit installation completed"
else
    echo "Zinit is already installed"
fi
