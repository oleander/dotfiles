- defaults:
    link:
      relink: true
      create: true
      force: false

- link:
    ~/.config/cargo/config.toml: configs/config/cargo/config.toml
    ~/.config/fish/config.fish: configs/config/fish/config.fish
    ~/.config/fish/fish_variables: configs/config/fish/fish_variables
    ~/.config/gh-copilot/config.yml: configs/config/gh-copilot/config.yml
    ~/.config/gh/config.yml: configs/config/gh/config.yml
    ~/.config/nvim/init.vim: configs/config/nvim/init.vim
    ~/.config/starship.toml: configs/config/starship.toml
    ~/.gemrc: configs/gemrc
    ~/.gitconfig: configs/gitconfig
    ~/.gitignore: configs/gitignore
    ~/.hushlogin: configs/hushlogin
    ~/.irbrc: configs/irbrc
    ~/.rspec: configs/rspec
    ~/.rubocop.yml: configs/rubocop.yml
    ~/.rustfmt.toml: configs/rustfmt.toml
    ~/.ssh/config:
      path: configs/ssh/config
      perm: 0644
    ~/.ssh/known_hosts:
      path: configs/ssh/known_hosts
      force: true
    ~/.config/karabiner/karabiner.json: configs/config/karabiner/karabiner.json
    ~/.zshrc:
      path: configs/zshrc
      force: true
    ~/.bashrc:
      path: configs/bashrc
      force: true

- create:
    ~/.ssh:
      perm: 0755

- ifhostname:
    hostname: homeassistant.local
    unmet: {}
    met:
      link:
        ~/.local:
          path: /share/ssh/local
          force: true
        ~/.cargo:
          path: /share/ssh/cargo
          force: true
        ~/.rustup:
          path: /share/ssh/rustup
          force: true
        create:
          - /share/ssh/rustup
          - /share/ssh/local
          - /share/ssh/cargo

- shell:
  - [git submodule update --init --recursive, Installing submodules]
  - [curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim, Installing vim-plug]
  - [nvim +PlugInstall! +qa, Installing plugins]
  # - [nvim -c "Copilot setup" +qa, Setting up Copilot]
  - [zsh -i -c 'exit', Setting up zsh]

