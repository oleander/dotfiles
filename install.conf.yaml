- defaults:
    link:
      relink: true
      create: true
      force: false

- create:
    ~/.ssh:
      perm: 0755

- link:
    ~/.dotfiles:
      relative: true
      path: .
    ~/:
      prefix: .
      glob: true
      path: configs/*
      exclude: [configs/config]
      force: true
    ~/.config:
      glob: true
      path: configs/config/**

- link:
    init.sh:
      if: test $(hostname) = homeassistant.local
      path: init/homeassistant.sh

- link:
    init.sh:
      if: test $(hostname) = macos.local
      path: init/macos.sh

- shell:
  - command: ./init.sh
    description: Execute init script for current host
  - command: curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim || echo Failed to install vim-plug
    description: Install vim-plug
  - command: nvim +PlugInstall! +qa || echo Failed to load plugin manager into neovim
    description: Load plugin manager into neovim
  - command: cd ./autojump && chmod +x ./install.py || echo Failed to make install script executable
    description: Make install script executable
  - command: cd ./autojump && SHELL=/bin/zsh ./install.py || echo Failed to install autojump
    description: Install autojump
  - command: curl -sS https://starship.rs/install.sh | sh -s -- --yes || echo Failed to install starship
    description: Install starship
  - command: zsh -i -c 'exit' || echo Failed to preload ZSH
    description: Preload ZSH
